disp(' The KHI-2 matrix :') % La matrice KHI-2 

p=[0.999  0.995  0.99  0.98  0.95  0.9  0.8  0.2  0.1  0.05  0.02  0.01  0.005  0.001 ]
KHI_2=[001 , 000.0000 , 000.0000 , 000.0002 , 000.0006 , 000.0039 , 000.0158 , 000.0642 , 001.6424 , 002.7055 , 003.8415 , 005.4119 , 006.6349 , 007.8794 , 010.8276 ;
002 , 000.0020 , 000.0100 , 000.0201 , 000.0404 , 000.1026 , 000.2107 , 000.4463 , 003.2189 , 004.6052 , 005.9915 , 007.8240 , 009.2103 , 010.5966 , 013.8155 ;
003 , 000.0243 , 000.0717 , 000.1148 , 000.1848 , 000.3518 , 000.5844 , 001.0052 , 004.6416 , 006.2514 , 007.8147 , 009.8374 , 011.3449 , 012.8382 , 016.2662 ;
004 , 000.0908 , 000.2070 , 000.2971 , 000.4294 , 000.7107 , 001.0636 , 001.6488 , 005.9886 , 007.7794 , 009.4877 , 011.6678 , 013.2767 , 014.8603 , 018.4668 ;
005 , 000.2102 , 000.4117 , 000.5543 , 000.7519 , 001.1455 , 001.6103 , 002.3425 , 007.2893 , 009.2364 , 011.0705 , 013.3882 , 015.0863 , 016.7496 , 020.5150 ;
006 , 000.3811 , 000.6757 , 000.8721 , 001.1344 , 001.6354 , 002.2041 , 003.0701 , 008.5581 , 010.6446 , 012.5916 , 015.0332 , 016.8119 , 018.5476 , 022.4577 ;
007 , 000.5985 , 000.9893 , 001.2390 , 001.5643 , 002.1673 , 002.8331 , 003.8223 , 009.8032 , 012.0170 , 014.0671 , 016.6224 , 018.4753 , 020.2777 , 024.3219 ;
008 , 000.8571 , 001.3444 , 001.6465 , 002.0325 , 002.7326 , 003.4895 , 004.5936 , 011.0301 , 013.3616 , 015.5073 , 018.1682 , 020.0902 , 021.9550 , 026.1245 ;
009 , 001.1519 , 001.7349 , 002.0879 , 002.5324 , 003.3251 , 004.1682 , 005.3801 , 012.2421 , 014.6837 , 016.9190 , 019.6790 , 021.6660 , 023.5894 , 027.8772 ;
010 , 001.4787 , 002.1559 , 002.5582 , 003.0591 , 003.9403 , 004.8652 , 006.1791 , 013.4420 , 015.9872 , 018.3070 , 021.1608 , 023.2093 , 025.1882 , 029.5883 ;
011 , 001.8339 , 002.6032 , 003.0535 , 003.6087 , 004.5748 , 005.5778 , 006.9887 , 014.6314 , 017.2750 , 019.6751 , 022.6179 , 024.7250 , 026.7568 , 031.2641 ;
012 , 002.2142 , 003.0738 , 003.5706 , 004.1783 , 005.2260 , 006.3038 , 007.8073 , 015.8120 , 018.5493 , 021.0261 , 024.0540 , 026.2170 , 028.2995 , 032.9095 ;
013 , 002.6172 , 003.5650 , 004.1069 , 004.7654 , 005.8919 , 007.0415 , 008.6339 , 016.9848 , 019.8119 , 022.3620 , 025.4715 , 027.6882 , 029.8195 , 034.5282 ;
014 , 003.0407 , 004.0747 , 004.6604 , 005.3682 , 006.5706 , 007.7895 , 009.4673 , 018.1508 , 021.0641 , 023.6848 , 026.8728 , 029.1412 , 031.3193 , 036.1233 ;
015 , 003.4827 , 004.6009 , 005.2293 , 005.9849 , 007.2609 , 008.5468 , 010.3070 , 019.3107 , 022.3071 , 024.9958 , 028.2595 , 030.5779 , 032.8013 , 037.6973 ;
016 , 003.9416 , 005.1422 , 005.8122 , 006.6142 , 007.9616 , 009.3122 , 011.1521 , 020.4651 , 023.5418 , 026.2962 , 029.6332 , 031.9999 , 034.2672 , 039.2524 ;
017 , 004.4161 , 005.6972 , 006.4078 , 007.2550 , 008.6718 , 010.0852 , 012.0023 , 021.6146 , 024.7690 , 027.5871 , 030.9950 , 033.4087 , 035.7185 , 040.7902 ;
018 , 004.9048 , 006.2648 , 007.0149 , 007.9062 , 009.3905 , 010.8649 , 012.8570 , 022.7595 , 025.9894 , 028.8693 , 032.3462 , 034.8053 , 037.1565 , 042.3124 ;
019 , 005.4068 , 006.8440 , 007.6327 , 008.5670 , 010.1170 , 011.6509 , 013.7158 , 023.9004 , 027.2036 , 030.1435 , 033.6874 , 036.1909 , 038.5823 , 043.8202 ;
020 , 005.9210 , 007.4338 , 008.2604 , 009.2367 , 010.8508 , 012.4426 , 014.5784 , 025.0375 , 028.4120 , 031.4104 , 035.0196 , 037.5662 , 039.9968 , 045.3147 ;
021 , 006.4467 , 008.0337 , 008.8972 , 009.9146 , 011.5913 , 013.2396 , 015.4446 , 026.1711 , 029.6151 , 032.6706 , 036.3434 , 038.9322 , 041.4011 , 046.7970 ;
022 , 006.9830 , 008.6427 , 009.5425 , 010.6000 , 012.3380 , 014.0415 , 016.3140 , 027.3015 , 030.8133 , 033.9244 , 037.6595 , 040.2894 , 042.7957 , 048.2679 ;
023 , 007.5292 , 009.2604 , 010.1957 , 011.2926 , 013.0905 , 014.8480 , 017.1865 , 028.4288 , 032.0069 , 035.1725 , 038.9683 , 041.6384 , 044.1813 , 049.7282 ;
024 , 008.0849 , 009.8862 , 010.8564 , 011.9918 , 013.8484 , 015.6587 , 018.0618 , 029.5533 , 033.1962 , 036.4150 , 040.2704 , 042.9798 , 045.5585 , 051.1786 ;
025 , 008.6493 , 010.5197 , 011.5240 , 012.6973 , 014.6114 , 016.4734 , 018.9398 , 030.6752 , 034.3816 , 037.6525 , 041.5661 , 044.3141 , 046.9279 , 052.6197 ;
026 , 009.2221 , 011.1602 , 012.1981 , 013.4086 , 015.3792 , 017.2919 , 019.8202 , 031.7946 , 035.5632 , 038.8851 , 042.8558 , 045.6417 , 048.2899 , 054.0520 ;
027 , 009.8028 , 011.8076 , 012.8785 , 014.1254 , 016.1514 , 018.1139 , 020.7030 , 032.9117 , 036.7412 , 040.1133 , 044.1400 , 046.9629 , 049.6449 , 055.4760 ;
028 , 010.3909 , 012.4613 , 013.5647 , 014.8475 , 016.9279 , 018.9392 , 021.5880 , 034.0266 , 037.9159 , 041.3371 , 045.4188 , 048.2782 , 050.9934 , 056.8923 ;
029 , 010.9861 , 013.1211 , 014.2565 , 015.5745 , 017.7084 , 019.7677 , 022.4751 , 035.1394 , 039.0875 , 042.5570 , 046.6927 , 049.5879 , 052.3356 , 058.3012 ;
030 , 011.5880 , 013.7867 , 014.9535 , 016.3062 , 018.4927 , 020.5992 , 023.3641 , 036.2502 , 040.2560 , 043.7730 , 047.9618 , 050.8922 , 053.6720 , 059.7031 ;
040 , 017.9164 , 020.7065 , 022.1643 , 023.8376 , 026.5093 , 029.0505 , 032.3450 , 047.2685 , 051.8051 , 055.7585 , 060.4361 , 063.6907 , 066.7660 , 073.4020 ;
050 , 024.6739 , 027.9907 , 029.7067 , 031.6639 , 034.7643 , 037.6886 , 041.4492 , 058.1638 , 063.1671 , 067.5048 , 072.6133 , 076.1539 , 079.4900 , 086.6608 ;
060 , 031.7383 , 035.5345 , 037.4849 , 039.6994 , 043.1880 , 046.4589 , 050.6406 , 068.9721 , 074.3970 , 079.0819 , 084.5799 , 088.3794 , 091.9517 , 099.6072 ;
070 , 039.0364 , 043.2752 , 045.4417 , 047.8934 , 051.7393 , 055.3289 , 059.8978 , 079.7146 , 085.5270 , 090.5312 , 096.3875 , 100.4252 , 104.2149 , 112.3169 ;
080 , 046.5199 , 051.1719 , 053.5401 , 056.2128 , 060.3915 , 064.2778 , 069.2069 , 090.4053 , 096.5782 , 101.8795 , 108.0693 , 112.3288 , 116.3211 , 124.8392 ;
090 , 054.1552 , 059.1963 , 061.7541 , 064.6347 , 069.1260 , 073.2911 , 078.5584 , 101.0537 , 107.5650 , 113.1453 , 119.6485 , 124.1163 , 128.2989 , 137.2084 ;
100 , 061.9179 , 067.3276 , 070.0649 , 073.1422 , 077.9295 , 082.3581 , 087.9453 , 111.6667 , 118.4980 , 124.3421 , 131.1417 , 135.8067 , 140.1695 , 149.4493 ;
120 , 077.7551 , 083.8516 , 086.9233 , 090.3667 , 095.7046 , 100.6236 , 106.8056 , 132.8063 , 140.2326 , 146.5674 , 153.9182 , 158.9502 , 163.6482 , 173.6174 ;
140 , 093.9256 , 100.6548 , 104.0344 , 107.8149 , 113.6593 , 119.0293 , 125.7581 , 153.8537 , 161.8270 , 168.6130 , 176.4709 , 181.8403 , 186.8468 , 197.4508 ;
160 , 110.3603 , 117.6793 , 121.3456 , 125.4400 , 131.7561 , 137.5457 , 144.7834 , 174.8283 , 183.3106 , 190.5165 , 198.8464 , 204.5301 , 209.8239 , 221.0190 ;
180 , 127.0111 , 134.8844 , 138.8204 , 143.2096 , 149.9688 , 156.1526 , 163.8682 , 195.7434 , 204.7037 , 212.3039 , 221.0772 , 227.0561 , 232.6198 , 244.3705 ;
200 , 143.8428 , 152.2410 , 156.4320 , 161.1003 , 168.2786 , 174.8353 , 183.0028 , 216.6088 , 226.0210 , 233.9943 , 243.1869 , 249.4451 , 255.2642 , 267.5405 ;
250 , 186.5541 , 196.1606 , 200.9386 , 206.2490 , 214.3916 , 221.8059 , 231.0128 , 268.5986 , 279.0504 , 287.8815 , 298.0388 , 304.9396 , 311.3462 , 324.8324 ;
300 , 229.9634 , 240.6634 , 245.9725 , 251.8637 , 260.8781 , 269.0679 , 279.2143 , 320.3971 , 331.7885 , 341.3951 , 352.4246 , 359.9064 , 366.8444 , 381.4252 ;
400 , 318.2596 , 330.9028 , 337.1553 , 344.0781 , 354.6410 , 364.2074 , 376.0218 , 423.5895 , 436.6490 , 447.6325 , 460.2108 , 468.7245 , 476.6064 , 493.1318 ;
500 , 407.9470 , 422.3034 , 429.3875 , 437.2194 , 449.1468 , 459.9261 , 473.2099 , 526.4014 , 540.9303 , 553.1268 , 567.0698 , 576.4928 , 585.2066 , 603.4460 ;
600 , 498.6229 , 514.5289 , 522.3651 , 531.0191 , 544.1801 , 556.0560 , 570.6680 , 628.9433 , 644.8004 , 658.0936 , 673.2703 , 683.5156 , 692.9816 , 712.7712 ;
700 , 590.0480 , 607.3795 , 615.9075 , 625.3175 , 639.6130 , 652.4973 , 668.3308 , 731.2805 , 748.3591 , 762.6607 , 778.9721 , 789.9735 , 800.1314 , 821.3468 ;
800 , 682.0665 , 700.7250 , 709.8969 , 720.0107 , 735.3623 , 749.1852 , 766.1555 , 833.4557 , 851.6712 , 866.9114 , 884.2789 , 895.9843 , 906.7862 , 929.3289 ;
900 , 774.5698 , 794.4750 , 804.2517 , 815.0267 , 831.3702 , 846.0746 , 864.1125 , 935.4987 , 954.7819 , 970.9036 , 989.2631 , 1001.6296 ,1013.0364 ,1036.8260]

niveau_de_signification=0.05

disp(' observed data : ') 

donnees_observees= [36,34,14,16]

[h,w]=size(donnees_observees)
if h==1
    
    ddl=(w-1)*(h)
else
    ddl=(w-1)*(h-1)
end
donnees_theoriques=donnees_observees;

if h == 1
    n = sum(donnees_observees,'all');
    val=n/w;
    donnees_theoriques(1:w)=val;

else 
        somme1= sum(donnees_observees,1)
        somme2= sum(donnees_observees,2)
        somme3=sum(somme2,1)

        for i=1:w
            for j=1:h
                donnees_theoriques(i,j)= (somme1(j)*somme2(i))/somme3;
            end
        end
    
    
end
  


disp(' theoretical data : ') 

donnees_theoriques


x_calculer=0;
for i=1:h
    for j=1:w
        x_calculer=x_calculer+( (donnees_observees(i,j) - donnees_theoriques(i,j) ).^2 /donnees_theoriques(i,j));
    end
end



val2=0;
size(p,2);
for i=1:size(p,2)
	if p(i)==niveau_de_signification
        val2=i+1;
        break
    end
end
val2
val3=0;

KHI_2(:,1)

for i=1:size(KHI_2(:,1),1)
    if KHI_2(i,1)>=ddl
        val3=i
        break
    end
end


if (x_calculer > x_theorique )
    disp('null hypothesis rejected, So there is a link between the factors and the choice')
    le_coefficient_de_contingence=  ( (x_calculer).^2/(n+ (x_calculer).^2 )  ).^(1/2)
    if le_coefficient_de_contingence<0.5
        disp("The value is close to 0 , the bond is weak.")
    else
        disp("The value is close to 1, the bond is strong.")
    end
    
else
    disp('null hypothesis accepted, So there is no link between the factors and the choice')
end

x = 0:0.1:16;
y = chi2pdf(x,3);
x2= x_theorique;


figure;
plot(x2,y,'g*')
hold on
plot(x,y,'b-o')
xlabel('Observation', 'Color', 'b')
ylabel('Probability Density', 'Color', 'b')
hold on
